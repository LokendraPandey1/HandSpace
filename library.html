<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HandSpace Library</title>
    <link rel="stylesheet" href="style_platform.css">

    <!-- Three.js Import Map (Required because modelLoader.js imports three) -->
    <script type="importmap">
        {
            "imports": {
                "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
                "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/"
            }
        }
    </script>

    <script type="module">
        import { initNavbar } from './src/ui/navbar.js';
        import { MODELS } from './src/models/modelLoader.js'; // Import models source

        initNavbar('library');

        // Dynamically load models into the grid
        window.onload = () => {
            const grid = document.getElementById('library-grid');

            // Group by category
            const categories = {};
            MODELS.forEach(m => {
                if (!categories[m.category]) categories[m.category] = [];
                categories[m.category].push(m);
            });

            // Render
            for (const [cat, models] of Object.entries(categories)) {
                // Section Header
                const header = document.createElement('h2');
                header.style.gridColumn = '1 / -1';
                header.style.marginTop = '40px';
                header.style.borderBottom = '1px solid rgba(255,255,255,0.1)';
                header.style.paddingBottom = '10px';
                header.innerText = cat;
                grid.appendChild(header);

                models.forEach(m => {
                    const card = document.createElement('div');
                    card.className = 'card-glass';
                    card.style.display = 'flex';
                    card.style.flexDirection = 'column';
                    card.style.alignItems = 'center';
                    card.style.textAlign = 'center';

                    // Placeholder Icon based on category
                    let icon = 'ğŸ“¦';
                    if (cat === 'Anatomy') icon = 'ğŸ¦´';
                    if (cat === 'Space') icon = 'ğŸš€';
                    if (cat === 'Engineering') icon = 'âš™ï¸';
                    if (m.name.includes('Heart')) icon = 'ğŸ«€';
                    if (m.name.includes('Brain')) icon = 'ğŸ§ ';
                    if (m.name.includes('Lungs')) icon = 'ğŸ«';

                    card.innerHTML = `
                        <div style="font-size: 3rem; margin-bottom: 15px;">${icon}</div>
                        <h3 style="margin: 0 0 10px 0; color: #00f2fe;">${m.name}</h3>
                        <p style="color: #aaa; font-size: 0.9rem; margin-bottom: 20px;">Interactive 3D Model</p>
                        <a href="index.html?model=${encodeURIComponent(m.file)}" class="btn-primary" style="width: 100%; box-sizing: border-box; text-align: center;">Explore Model</a>
                    `;
                    grid.appendChild(card);
                });
            }
        };
    </script>
</head>

<body class="platform-page">

    <!-- Navbar injected here -->

    <div class="dashboard-container">

        <div class="welcome-header">
            <h1>Course Library ğŸ“š</h1>
            <p style="color: #aaa; font-size: 1.2rem;">Select a model to begin your interactive lesson.</p>
        </div>

        <div id="library-grid" class="model-grid" style="grid-column: span 12;">
            <!-- Content Injected via JS -->
        </div>

    </div>

</body>

</html>